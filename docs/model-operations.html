<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>evops app user manual - Model operations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./statistical-models.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="mermaid-theme" content="forest">
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./statistical-models.html">Model</a></li><li class="breadcrumb-item"><a href="./model-operations.html">Model operations</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">evops app user manual</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Home</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Install</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup-docker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup docker desktop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup-evops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup evops app</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Manage</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manage-evops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manage evops app</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Manipulate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipulate-evops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manipulate evops app</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data operations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistical-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-operations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Model operations</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#statistical-learning-analysis-sla-pipeline-mandatory" id="toc-statistical-learning-analysis-sla-pipeline-mandatory" class="nav-link active" data-scroll-target="#statistical-learning-analysis-sla-pipeline-mandatory">Statistical Learning Analysis (sla) pipeline: <em>Mandatory</em></a></li>
  <li><a href="#extreme-value-analysis-eva-pipeline-independent" id="toc-extreme-value-analysis-eva-pipeline-independent" class="nav-link" data-scroll-target="#extreme-value-analysis-eva-pipeline-independent">Extreme Value Analysis (eva) pipeline: <em>Independent</em></a>
  <ul>
  <li><a href="#sec-evasimuateddata" id="toc-sec-evasimuateddata" class="nav-link" data-scroll-target="#sec-evasimuateddata">Illustration on simulated datasets</a>
  <ul class="collapse">
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution">Normal Distribution</a></li>
  <li><a href="#gamma-distribution" id="toc-gamma-distribution" class="nav-link" data-scroll-target="#gamma-distribution">Gamma Distribution</a></li>
  <li><a href="#gev-distribution" id="toc-gev-distribution" class="nav-link" data-scroll-target="#gev-distribution">GEV Distribution</a></li>
  </ul></li>
  <li><a href="#sec-evarealdata" id="toc-sec-evarealdata" class="nav-link" data-scroll-target="#sec-evarealdata">Application on real dataset</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./statistical-models.html">Model</a></li><li class="breadcrumb-item"><a href="./model-operations.html">Model operations</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Model operations</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- ##  Exploit evops app model pipelines -->
<section id="statistical-learning-analysis-sla-pipeline-mandatory" class="level2">
<h2 class="anchored" data-anchor-id="statistical-learning-analysis-sla-pipeline-mandatory">Statistical Learning Analysis (sla) pipeline: <em>Mandatory</em></h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rerunning this pipeline with eventually modified input arguments on the same dataset of a given experimentation will overwrite all results generated during the previous run.</p>
</div>
</div>
<p>The notebook associated with <strong>sla_pipeline</strong> is the file <strong>sla_pipeline.ipynb</strong>. The main objective of this pipeline is to estimate the parameters of (<strong>stationary</strong> and <strong>non stationary</strong>) arithmetic mixture of gev models based on train datasets and to exploit the fitted model to predict return levels associated with given return period conditional on test predictor variables. Here, the train and test datasets must be those generated by <strong>itl_pipeline</strong>.</p>
<p>To run <strong>sla_pipeline</strong>, the studied response variable name must be assigned to the input argument <strong>response_var</strong>. In addition, the folder names containing <strong>raw</strong> train and test datasets must be assigned to the input arguments <strong>experimentation_train_dir</strong> and <strong>experimentation_test_dir</strong>. These three input arguments must match those used in <strong>itl_pipeline</strong> to create the considered train and test datasets. Note that the estimated models are automatically stored for future use since <strong>sla_pipeline</strong> can take a while to complete. Thus, a Boolean value must be assigned to the input argument <strong>use_pre_trained_models</strong> to indicate whether to load and exploit pre-trained models provided that they exist.</p>
<p>All numerical and graphical outputs are displayed in the notebook. Some numerical outputs are stored in the sub folder <strong>processed_data</strong> of the directory whose name is assigned to the variable <strong>experimentation_train_dir</strong>. In the directory <strong>processed_data</strong>, the sub folder whose name is the value assigned to the input argument <strong>response_var</strong> includes the csv files conventionally named as follows.</p>
<ul>
<li><p><strong>experimentation_train_dir+response_var+stationary_model_estimates.csv</strong>: It is the file which contains the estimated parameters of the <strong>stationary</strong> arithmetic gev mixture model fitted using only the train response variable.</p></li>
<li><p><strong>experimentation_train_dir+response_var+non_stationary_model_estimates.csv</strong>: It is the file which contains the estimated parameters of the <strong>non stationary</strong> arithmetic gev mixture model fitted using both the train response variable and train predictor variables.</p></li>
<li><p><strong>experimentation_train_dir+response_var+arithmetic_gev_mixture_model.rds</strong>: It is the file which contains all useful information about the estimated <strong>stationary</strong> arithmetic gev mixture model. This file, if it exists, is loaded for model exploitation when the parameter <strong>use_pre_trained_models</strong> is set to <strong>TRUE</strong>.</p></li>
<li><p><strong>experimentation_train_dir+response_var+arithmetic_ns_gev_mixture_model.rds</strong>: It is the file which contains all useful information about the estimated <strong>non stationary</strong> arithmetic gev mixture model. This file, if it exists, is loaded for model exploitation when the parameter <strong>use_pre_trained_models</strong> is set to <strong>TRUE</strong>.</p></li>
<li><p><strong>experimentation_train_dir+response_var+sample.csv</strong>: It is the file which contains a sample of the response variable generated using the fitted <strong>stationary</strong> arithmetic gev mixture model. The sample size can be modified as per needs. Its default value is equal to the number of observations in the train datasets.</p></li>
<li><p><strong>experimentation_train_dir+response_var+importance.csv</strong>: It is the file which contains the <strong>contribution</strong> or <strong>importance</strong> of the predictor variables on the expected exceedance above the maximum value of the train response variable.</p></li>
<li><p><strong>experimentation_train_dir+experimentation_test_dir+response_var+return_periods.csv</strong>: It is the file which contains return periods of observations in the test response variable conditional on their respective test predictor variables.</p></li>
<li><p><strong>experimentation_train_dir+experimentation_test_dir+response_var+return_levels.csv</strong>: It is the file which contains return levels of the response variable conditional on the observed test predictor variables. The common return period associated with these return levels can be modified as per needs. Its default value is equal to the number of observations in the train datasets.</p></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  I[Input] --&gt; A(experimentation_train_dir)
  I[Input] --&gt; B(experimentation_test_dir)
  I[Input] --&gt; C(response_var)
  I[Input] --&gt; C1(use_pre_trained_models)
  A --&gt; D{sla_pipeline}
  B --&gt; D
  C --&gt; D
  C1 --&gt; D
  D --&gt; O[output]
  O --&gt; E(experimentation_train_dir)
  E --&gt; F(processed_data)
  F --&gt; G(response_var)
  G --&gt; G5(experimentation_train_dir+response_var+stationary_model_estimates.csv)
  G --&gt; G6(experimentation_train_dir+response_var+non_stationary_model_estimates.csv)
  G --&gt; G9(experimentation_train_dir+response_var+arithmetic_gev_mixture_model.rds)
  G --&gt; G10(experimentation_train_dir+response_var+arithmetic_ns_gev_mixture_model.rds)
  G --&gt; G3(experimentation_train_dir+response_var+sample.csv)
  G --&gt; G4(experimentation_train_dir+response_var+importance.csv)
  G --&gt; G7(experimentation_train_dir+experimentation_test_dir+response_var+return_periods.csv)
  G --&gt; G8(experimentation_train_dir+experimentation_test_dir+response_var+return_levels.csv)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  I[Input] --&gt; A(experimentation_train_dir)
  I[Input] --&gt; B(experimentation_test_dir)
  I[Input] --&gt; C(response_var)
  I[Input] --&gt; C1(use_pre_trained_models)
  A --&gt; D{sla_pipeline}
  B --&gt; D
  C --&gt; D
  C1 --&gt; D
  D --&gt; O[output]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  O[output] --&gt; E(experimentation_train_dir)
  E --&gt; F(processed_data)
  F --&gt; G(response_var)
  G --&gt; G5(experimentation_train_dir+response_var+stationary_model_estimates.csv)
  G --&gt; G6(experimentation_train_dir+response_var+non_stationary_model_estimates.csv)
  G --&gt; G9(experimentation_train_dir+response_var+arithmetic_gev_mixture_model.rds)
  G --&gt; G10(experimentation_train_dir+response_var+arithmetic_ns_gev_mixture_model.rds)
  G --&gt; G3(experimentation_train_dir+response_var+sample.csv)
  G --&gt; G4(experimentation_train_dir+response_var+importance.csv)
  G --&gt; G7(experimentation_train_dir+experimentation_test_dir+response_var+return_periods.csv)
  G --&gt; G8(experimentation_train_dir+experimentation_test_dir+response_var+return_levels.csv)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="extreme-value-analysis-eva-pipeline-independent" class="level2">
<h2 class="anchored" data-anchor-id="extreme-value-analysis-eva-pipeline-independent">Extreme Value Analysis (eva) pipeline: <em>Independent</em></h2>
<p>There are currently four notebooks associated with <strong>eva_pipeline</strong>, namely <strong>eva_pipeline_normal.ipynb</strong>, <strong>eva_pipeline_gamma.ipynb</strong>, <strong>eva_pipeline_gev.ipynb</strong> and <strong>eva_pipeline.ipynb</strong>. The first three notebooks are intended to test <strong>eva_pipeline</strong> on simulated data (see <a href="#sec-evasimuateddata" class="quarto-xref">Section&nbsp;2.1</a> for more details) whereas the last notebook is intended to apply <strong>eva_pipeline</strong> on custom data (see <a href="#sec-evarealdata" class="quarto-xref">Section&nbsp;2.2</a> for more details).</p>
<section id="sec-evasimuateddata" class="level3">
<h3 class="anchored" data-anchor-id="sec-evasimuateddata">Illustration on simulated datasets</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rerunning the pipelines of this section with modified input arguments will overwrite all results generated during the previous run.</p>
</div>
</div>
<section id="normal-distribution" class="level4">
<h4 class="anchored" data-anchor-id="normal-distribution">Normal Distribution</h4>
<p>The notebook associated with <strong>eva_pipeline</strong> for data from a normal distribution is the file <strong>eva_pipeline_normal.ipynb</strong>. The main objective of this pipeline is to estimate the parameters of <strong>stationary</strong> geometric mixture of gev models based on simulated data from a normal probability distribution and to exploit the fitted model to predict return levels and expected exceedances associated with given return periods. In addition, the true return levels of the underlying normal law are provided for comparison.</p>
<p>The <strong>eva_pipeline</strong> for normal distribution requires three main information as input. The first is the number of normal data to simulate. This number must be assigned to the input argument <strong>n</strong>. The second and third are the mean and standard deviation parameters of the normal law to use. These two quantities must be assigned to the input arguments <strong>mean</strong> and <strong>sd</strong>, respectively. Note that the estimated models are automatically stored for future use since <strong>eva_pipeline</strong> can take a while to complete. Thus, a Boolean value must be assigned to the input argument <strong>use_pre_trained_models</strong> to indicate whether to load and exploit pre-trained models provided that they exist.</p>
<p>All numerical and graphical outputs are displayed in the notebook. Some numerical outputs are stored in the <strong>normal_distribution_results</strong> directory as csv files conventionally named as follows.</p>
<ul>
<li><p><strong>sample_normal_data.csv</strong>: It is the file which contains the simulated normal data using the provided input arguments.</p></li>
<li><p><strong>sample_normal_data_simulations_gev_mixture_model_estimates.csv</strong>: It is the file which contains the estimated parameters of the <strong>stationary</strong> geometric gev mixture model fitted using the simulated normal data.</p></li>
<li><p><strong>sample_normal_data_simulations_gev_mixture_models.rds</strong>: It is the file which contains all useful information about the estimated <strong>stationary</strong> geometric gev mixture model. This file, if it exists, is loaded for model exploitation when the parameter <strong>use_pre_trained_models</strong> is set to <strong>TRUE</strong>.</p></li>
<li><p><strong>sample_normal_data_simulations_return_levels.csv</strong>: It is the file which contains estimated and true return levels of the normal law. The return periods associated with these return levels range from the number of observations in the simulated normal data to one million times that number. The used default values of return periods can be modified as per needs.</p></li>
<li><p><strong>sample_normal_data_simulations_custom_extrapolation.csv</strong>: It is the file which contains estimated and true return levels of the normal law. More precisely, this file contains the return levels from all component gev laws in the geometric mixture model. The return period associated with these return levels is the number of observations in the simulated normal data. This default value of return period can be modified as per needs.</p></li>
<li><p><strong>sample_normal_data_simulations_expected_exceedance.csv</strong>: It is the file which contains the estimated expected exceedances of a given threshold related to the input normal law for all gev models in the fitted geometric gev mixture model. The default value of that threshold is the maximum value of the simulated normal data. This value can be modified as per needs.</p></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  I[Input] --&gt; A(n)
  I[Input] --&gt; B(mean)
  I[Input] --&gt; C(sd)
  I[Input] --&gt; C1(use_pre_trained_models)
  A --&gt; D{eva_pipeline}
  B --&gt; D
  C --&gt; D
  C1 --&gt; D
  D --&gt; O[output]
  O --&gt; E(normal_distribution_results)
  E --&gt; E1(sample_normal_data.csv)
  E --&gt; E2(sample_normal_data_simulations_gev_mixture_model_estimates.csv)
  E --&gt; E5(sample_normal_data_simulations_gev_mixture_models.rds)
  E --&gt; E3(sample_normal_data_simulations_return_levels.csv)
  E --&gt; E6(sample_normal_data_simulations_custom_extrapolation.csv)
  E --&gt; E4(sample_normal_data_simulations_expected_exceedance.csv)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="gamma-distribution" class="level4">
<h4 class="anchored" data-anchor-id="gamma-distribution">Gamma Distribution</h4>
<p>The notebook associated with <strong>eva_pipeline</strong> for data from a gamma distribution is the file <strong>eva_pipeline_gamma.ipynb</strong>. The main objective of this pipeline is to estimate the parameters of <strong>stationary</strong> geometric mixture of gev models based on simulated data from a gamma probability distribution and to exploit the fitted model to predict return levels and expected exceedances associated with given return periods. In addition, the true return levels of the underlying gamma law are provided for comparison.</p>
<p>The <strong>eva_pipeline</strong> for gamma distribution requires three main information as input. The first is the number of gamma data to simulate. This number must be assigned to the input argument <strong>n</strong>. The second and third are the shape and scale parameters of the gamma law to use. These two quantities must be assigned to the input arguments <strong>shape</strong> and <strong>scale</strong>, respectively. Note that the estimated models are automatically stored for future use since <strong>eva_pipeline</strong> can take a while to complete. Thus, a Boolean value must be assigned to the input argument <strong>use_pre_trained_models</strong> to indicate whether to load and exploit pre-trained models provided that they exist.</p>
<p>All numerical and graphical outputs are displayed in the notebook. Some numerical outputs are stored in the <strong>gamma_distribution_results</strong> directory as csv files conventionally named as follows.</p>
<ul>
<li><p><strong>sample_gamma_data.csv</strong>: It is the file which contains the simulated gamma data using the provided input arguments.</p></li>
<li><p><strong>sample_gamma_data_simulations_gev_mixture_model_estimates.csv</strong>: It is the file which contains the estimated parameters of the <strong>stationary</strong> geometric gev mixture model fitted using the simulated gamma data.</p></li>
<li><p><strong>sample_gamma_data_simulations_gev_mixture_models.rds</strong>: It is the file which contains all useful information about the estimated <strong>stationary</strong> geometric gev mixture model. This file, if it exists, is loaded for model exploitation when the parameter <strong>use_pre_trained_models</strong> is set to <strong>TRUE</strong>.</p></li>
<li><p><strong>sample_gamma_data_simulations_return_levels.csv</strong>: It is the file which contains estimated and true return levels of the gamma law. The return periods associated with these return levels range from the number of observations in the simulated gamma data to one million times that number. The used default values of return periods can be modified as per needs.</p></li>
<li><p><strong>sample_gamma_data_simulations_custom_extrapolation.csv</strong>: It is the file which contains estimated and true return levels of the gamma law. More precisely, this file contains the return levels from all component gev laws in the geometric mixture model. The return period associated with these return levels is the number of observations in the simulated gamma data. This default value of return period can be modified as per needs.</p></li>
<li><p><strong>sample_gamma_data_simulations_expected_exceedance.csv</strong>: It is the file which contains the estimated expected exceedances of a given threshold related to the input gamma law for all gev models in the fitted geometric gev mixture model. The default value of that threshold is the maximum value of the simulated gamma data. This value can be modified as per needs.</p></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  I[Input] --&gt; A(n)
  I[Input] --&gt; B(shape)
  I[Input] --&gt; C(scale)
  I[Input] --&gt; C1(use_pre_trained_models)
  A --&gt; D{eva_pipeline}
  B --&gt; D
  C --&gt; D
  C1 --&gt; D
  D --&gt; O[output]
  O --&gt; E(gamma_distribution_results)
  E --&gt; E1(sample_gamma_data.csv)
  E --&gt; E2(sample_gamma_data_simulations_gev_mixture_model_estimates.csv)
  E --&gt; E5(sample_gamma_data_simulations_gev_mixture_models.rds)
  E --&gt; E3(sample_gamma_data_simulations_return_levels.csv)
  E --&gt; E6(sample_gamma_data_simulations_custom_extrapolation.csv)
  E --&gt; E4(sample_gamma_data_simulations_expected_exceedance.csv)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="gev-distribution" class="level4">
<h4 class="anchored" data-anchor-id="gev-distribution">GEV Distribution</h4>
<p>The notebook associated with <strong>eva_pipeline</strong> for data from a gev distribution is the file <strong>eva_pipeline_gev.ipynb</strong>. The main objective of this pipeline is to estimate the parameters of <strong>stationary</strong> geometric mixture of gev models based on simulated data from a gev probability distribution and to exploit the fitted model to predict return levels and expected exceedances associated with given return periods. In addition, the true return levels of the underlying gev law are provided for comparison.</p>
<p>The <strong>eva_pipeline</strong> for gev distribution requires four main information as input. The first is the number of gev data to simulate. This number must be assigned to the input argument <strong>n</strong>. The second, third and fourth are the shape, scale and location parameters of the gev law to use. These three quantities must be assigned to the input arguments <strong>shape</strong>, <strong>scale</strong> and <strong>loc</strong>, respectively. Note that the estimated models are automatically stored for future use since <strong>eva_pipeline</strong> can take a while to complete. Thus, a Boolean value must be assigned to the input argument <strong>use_pre_trained_models</strong> to indicate whether to load and exploit pre-trained models provided that they exist.</p>
<p>All numerical and graphical outputs are displayed in the notebook. Some numerical outputs are stored in the <strong>gev_distribution_results</strong> directory as csv files conventionally named as follows.</p>
<ul>
<li><p><strong>sample_gev_data.csv</strong>: It is the file which contains the simulated gev data using the provided input arguments.</p></li>
<li><p><strong>sample_gev_data_simulations_gev_mixture_model_estimates.csv</strong>: It is the file which contains the estimated parameters of the <strong>stationary</strong> geometric gev mixture model fitted using the simulated gev data.</p></li>
<li><p><strong>sample_gev_data_simulations_gev_mixture_models.rds</strong>: It is the file which contains all useful information about the estimated <strong>stationary</strong> geometric gev mixture model. This file, if it exists, is loaded for model exploitation when the parameter <strong>use_pre_trained_models</strong> is set to <strong>TRUE</strong>.</p></li>
<li><p><strong>sample_gev_data_simulations_return_levels.csv</strong>: It is the file which contains estimated and true return levels of the gev law. The return periods associated with these return levels range from the number of observations in the simulated gev data to one million times that number. The used default values of return periods can be modified as per needs.</p></li>
<li><p><strong>sample_gev_data_simulations_custom_extrapolation.csv</strong>: It is the file which contains estimated and true return levels of the gev law. More precisely, this file contains the return levels from all component gev laws in the geometric mixture model. The return period associated with these return levels is the number of observations in the simulated gev data. This default value of return period can be modified as per needs.</p></li>
<li><p><strong>sample_gev_data_simulations_expected_exceedance.csv</strong>: It is the file which contains the estimated expected exceedances of a given threshold related to the input gev law for all gev models in the fitted geometric gev mixture model. The default value of that threshold is the maximum value of the simulated gev data. This value can be modified as per needs.</p></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  I[Input] --&gt; A(n)
  I[Input] --&gt; B1(shape)
  I[Input] --&gt; B2(scale)
  I[Input] --&gt; B3(loc)
  I[Input] --&gt; C1(use_pre_trained_models)
  A --&gt; D{eva_pipeline}
  B1 --&gt; D
  B2 --&gt; D
  B3 --&gt; D
  C1 --&gt; D
  D --&gt; O[output]
  O --&gt; E(gev_distribution_results)
  E --&gt; E1(sample_gev_data.csv)
  E --&gt; E2(sample_gev_data_simulations_gev_mixture_model_estimates.csv)
  E --&gt; E5(sample_gev_data_simulations_gev_mixture_models.rds)
  E --&gt; E3(sample_gev_data_simulations_return_levels.csv)
  E --&gt; E6(sample_gev_data_simulations_custom_extrapolation.csv)
  E --&gt; E4(sample_gev_data_simulations_expected_exceedance.csv)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
<section id="sec-evarealdata" class="level3">
<h3 class="anchored" data-anchor-id="sec-evarealdata">Application on real dataset</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rerunning this pipeline with modified input arguments on a given uploaded dataset will overwrite all results generated during the previous run.</p>
</div>
</div>
<p>The notebook associated with <strong>eva_pipeline</strong> is the file <strong>eva_pipeline.ipynb</strong>. The main objective of this pipeline is to estimate the parameters of (<strong>stationary</strong>) geometric mixture of gev models based on train data and to exploit the fitted model to predict return levels and expected exceedances associated with given return periods.</p>
<p>The <strong>eva_pipeline</strong> requires two main information as input. The former is the csv file whose name is assigned to the input argument <strong>csv_file_name</strong>. This csv file must be uploaded in the <strong>workspace</strong> directory of the container running the evops app. The latter concerns the column name of the variable to consider in the file referenced by the argument <strong>csv_file_name</strong>. This column name must be assigned to the input argument <strong>variable_name</strong>. Note that the estimated models are automatically stored for future use since <strong>eva_pipeline</strong> can take a while to complete. Thus, a Boolean value must be assigned to the input argument <strong>use_pre_trained_models</strong> to indicate whether to load and exploit pre-trained models provided that they exist.</p>
<p>All numerical and graphical outputs are displayed in the notebook. Some numerical outputs are stored in the <strong>workspace</strong> directory of the container running the evops app as csv files conventionally named as follows.</p>
<ul>
<li><p><strong>csv_file_name+variable_name+gev_mixture_model_estimates.csv</strong>: It is the file which contains the estimated parameters of the <strong>stationary</strong> geometric gev mixture model fitted using the specified train data.</p></li>
<li><p><strong>csv_file_name+variable_name+gev_mixture_models.rds</strong>: It is the file which contains all useful information about the estimated <strong>stationary</strong> geometric gev mixture model. This file, if it exists, is loaded for model exploitation when the parameter <strong>use_pre_trained_models</strong> is set to <strong>TRUE</strong>.</p></li>
<li><p><strong>csv_file_name+variable_name+return_levels.csv</strong>: It is the file which contains estimated return levels of the fitted variable. The return periods associated with these return levels range from the number of observations in the train data to one million times that number. The used default values of return periods can be modified as per needs.</p></li>
<li><p><strong>csv_file_name+variable_name+custom_extrapolation.csv</strong>: It is the file which contains estimated and true return levels of the fitted variable. More precisely, this file contains the return levels from all component gev laws in the geometric mixture model. The return period associated with these return levels is the number of observations in the train data. This default value of return period can be modified as per needs.</p></li>
<li><p><strong>csv_file_name+variable_name+expected_exceedance.csv</strong>: It is the file which contains the expected exceedances of a given threshold related to the fitted variable for all gev models in the fitted geometric gev mixture model. The default value of that threshold is the maximum value of the train data. This value can be modified as per needs.</p></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  I[Input] --&gt; A(csv_file_name)
  I[Input] --&gt; B(variable_name)
  I[Input] --&gt; C1(use_pre_trained_models)
  A --&gt; C{eva_pipeline}
  B --&gt; C
  C1 --&gt; C
  C --&gt; O[output]
  O --&gt; D(workspace)
  D --&gt; D1(csv_file_name+variable_name+gev_mixture_model_estimates.csv)
  D --&gt; D4(csv_file_name+variable_name+gev_mixture_models.rds)
  D --&gt; D2(csv_file_name+variable_name+return_levels.csv)
  D --&gt; D5(csv_file_name+variable_name+custom_extrapolation.csv)
  D --&gt; D3(csv_file_name+variable_name+expected_exceedance.csv)
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./statistical-models.html" class="pagination-link  aria-label=" statistical="" models"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Statistical models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>